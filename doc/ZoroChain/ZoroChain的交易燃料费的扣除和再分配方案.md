## ZoroChain交易燃料费的扣除和再分配方案
### 交易燃料费的定义
* 在交易上链时，会运行该交易所携带的智能合约脚本，在此过程中需要根据脚本的运行代价支付对应的燃料费
* 类似于比特币的挖矿奖励机制，Zoro在出块时，会将块内所有交易的支付金额一并转给本次出块的共识节点（议长节点）作为奖励

### Zoro的燃料费机制
* Zoro采用类似以太坊的交易燃料费机制
* 为每一类脚本操作规定需要的燃料费，以此来计算一个交易总共需要消耗多少燃料费（Gas）
* 请注意这里的Gas仅表示Zoro上发起交易所需支付的系统费用，是一种虚拟的货币单位
* 在发起交易时，用户可以设定GasPrice和GasLimit
* GasPrice代表Gas转换成BCP的价格系数，即扣缴的BCP=交易所需的Gas*用户设定的GasPrice
* GasLimit是为该笔交易支付的Gas上限，最终被扣缴的Gas金额不会超过设定的GasLimit
* 和NEO一样，可以通过调用`invokescript`来预执行交易的脚本，在返回值里获得该笔交易需要消耗的燃料费

### GasPrice和GasLimit的作用
* 如果待处理的交易数量较多，交易将按照GasPrice从高到低的顺序进行排队，GasPrice高的交易将会优先完成上链
* GasPrice将有最小值和最大值得限制，以在折算BCP时，避免出现超出范围的数值
* GasLimit的作用是防止因为合约脚本的问题，导致出现巨额燃料费用的情况
* 如果设定的GasLimit低于交易所需的Gas，该交易将无法通过验证

### 交易燃料费的支付来源
* 一般来说，交易的发起者需要支付这笔交易所需要的燃料费，在向节点发送交易时，发起者需要为这笔交易设定GasPrice和GasLimit
* 应用链上的交易，除了交易发起者支付燃料费之外，还有一种从应用链的燃料费池中扣除费用的机制
* 应用链会有一个特殊的账户，会从这个账户中扣缴交易的燃料费，该应用链的开发者需要维持这个账户中的资金，以确保足够的金额支付燃料费

### 交易燃料费的验证
* 当节点接收到一个新发起的交易时，会对该交易进行验证
* 首先预执行该交易，得到所需的燃料费金额
* 然后检查设定的GasLimit，如果低于所需的Gas则拒绝接受该交易
* 再检查交易发起者账户中是否有足够的余额，如果余额不足也拒绝接受该交易
  * 因为没有使用UTXO模型，我们在交易的属性数据里存放发起人的验签脚本
  * 这个验签脚本可以作为账户地址，用来检查发起人的BCP账户里是否有足够的金额支付燃料费

### 燃料费的扣缴和再分配
* 在议长节点提交共识提案时，会生成一个MinerTransaction交易作为新区块的第一个交易
* 在这个块上链时，会依次处理这个块内的所有交易，运行该交易的智能合约，
* 在合约运行结束时，计算出消耗的燃料费，根据GasPrice计算出对应的BCP金额，从交易发起者的账户里扣除
* 在处理完所有的交易后，将所有交易支付的BCP总额作为奖励，转账给MinerTransaction里记录的共识节点账户